<div class="container">
  <h4 class="mb-3">비밀번호 변경</h4>

  <!-- 성공 시 -->
  <div th:if="${success}">
    <div class="alert alert-success">비밀번호가 변경되었습니다.</div>
    <script>
      alert('비밀번호가 변경되었습니다.');
      if (window.opener && !window.opener.closed) {
        try { window.opener.location.reload(); } catch(e) {}
      }
      window.close();
    </script>
  </div>

  <!-- 폼 -->
  <form th:action="@{/user/password}" method="post" th:object="${form}">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

    <!-- 글로벌 에러 -->
    <div th:if="${#fields.hasGlobalErrors()}" class="alert alert-danger" role="alert"
         th:each="err : ${#fields.globalErrors()}" th:text="${err}"></div>

    <div class="mb-3">
      <label class="form-label">현재 비밀번호</label>
      <input type="password" class="form-control" th:field="*{currentPassword}" autocomplete="current-password">
      <div class="text-danger small" th:if="${#fields.hasErrors('currentPassword')}" th:errors="*{currentPassword}"></div>
    </div>

    <div class="mb-3">
      <label class="form-label">새 비밀번호</label>
      <input type="password" class="form-control" th:field="*{newPassword}" autocomplete="new-password">
      <div class="text-danger small" th:if="${#fields.hasErrors('newPassword')}" th:errors="*{newPassword}"></div>
    </div>

    <div class="mb-3">
      <label class="form-label">새 비밀번호 확인</label>
      <input type="password" class="form-control" th:field="*{newPasswordConfirm}" autocomplete="new-password">
      <div class="text-danger small" th:if="${#fields.hasErrors('newPasswordConfirm')}" th:errors="*{newPasswordConfirm}"></div>
    </div>

    <button class="btn btn-primary w-100" type="submit">확인</button>
  </form>
</div>
